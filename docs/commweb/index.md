# CommWeb

## Overview

Commonwealth Bank of Australia is a multinational bank, offering many of Australia's leading financial services. Mageplaza CommWeb extension will allow you to allow payment via Commonwealth Bank on the store of Magento 2. With CommWeb, you can make online payments quickly and reliably.

Mageplaza CommWeb extension allows customers to make payments with MasterCard, Visa, Discover, American Express, Diners, JBC.
It also is compatible with Mageplaza One Step Checkout extension and Payment Restriction extension.

## Download and Install

- Download CommWeb extension
- [Installation guide](https://www.mageplaza.com/install-magento-2-extension/)

## How to use

### 1. Commonwealth Bank

- To be able to configure CommWeb you need a **Commonwealth Bank** account.

- Go to [this link](https://commbank.simplify.com/commerce/login/auth#/account/apiKeys) to login to **Commonwealth Bank**. After login sucessfully, from the left sidebar, select `Account Settings > Account Settings > Account Details > Select API Keys` to get **Public Key** and **Private Key**

![](https://i.imgur.com/af4plQT.png)

### 2. Make payments with CommWeb

- **Checkout page**: select **CommWeb payment method**. Enter credit card information including: **Credit Card Number, Expiration Date, Card Verification Number**.

![](https://i.imgur.com/BbnO9do.png)

- **Magento Default**: Displays CommWeb payment by default of Magento

![](https://i.imgur.com/BbnO9do.png)

- **Popup Checkout**: Displays CommWeb payment when clicking the **Place Order** button

![](https://i.imgur.com/ujy0wGs.png)

- **Iframe Checkout**: CommWeb payment method is displayed as iframes

![](https://i.imgur.com/XeQIBB6.png)

**Note**: To be able to make payments with CommWeb, the currency on the Magento site needs to match the currency of **Commonwealth Bank**.

- To set currency for the Commonwealth Bank, log in to your Commonwealth Bank account. Then from the left sidebar, select `Account Settings > Account Settings > Developer`, at the droplist, select the appropriate currency.

![](https://i.imgur.com/3lLXOgk.png)

### Test card numbers

<p>&nbsp;</p>
<table>
<tbody>
<tr>
<td>
<p><strong>Card Number</strong></p>
</td>
<td>
<p><strong>Card Type</strong></p>
</td>
<td>
<p><strong>Payment Status</strong></p>
</td>
<td>
<p><strong>Refund Status</strong></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">2222 4053 4324 8877</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">2222 9909 0525 7051</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">2223 0076 4872 6984</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">2223 5771 2001 7656</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5105 1051 0510 5100</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5111 0100 3017 5156</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5185 5408 1000 0019</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5200 8282 8282 8210</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5204 2300 8000 0017</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5204 7400 0990 0014</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5420 9238 7872 4339</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5455 3307 6000 0018</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5506 9004 9000 0436</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5506 9004 9000 0444</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5506 9005 1000 0234</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5506 9208 0924 3667</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5506 9224 0063 4930</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5506 9274 2731 7625</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5553 0422 4198 4105</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5555 5537 5304 8194</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">5555 5555 5555 4444</span></p>
</td>
<td>
<p><span style="font-weight: 400;">MasterCard</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">4012 8888 8888 1881</span></p>
</td>
<td>
<p><span style="font-weight: 400;">Visa</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">4111 1111 1111 1111</span></p>
</td>
<td>
<p><span style="font-weight: 400;">Visa</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">6011 0009 9013 9424</span></p>
</td>
<td>
<p><span style="font-weight: 400;">Discover</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">6011 1111 1111 1117</span></p>
</td>
<td>
<p><span style="font-weight: 400;">Discover</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">3714 496353 98431</span></p>
</td>
<td>
<p><span style="font-weight: 400;">American Express</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">3782 822463 10005</span></p>
</td>
<td>
<p><span style="font-weight: 400;">American Express</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">3056 9309 0259 04</span></p>
</td>
<td>
<p><span style="font-weight: 400;">Diners</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">3852 0000 0232 37</span></p>
</td>
<td>
<p><span style="font-weight: 400;">Diners</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">3530 1113 3330 0000</span></p>
</td>
<td>
<p><span style="font-weight: 400;">JCB</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
<tr>
<td>
<p><span style="font-weight: 400;">3566 0020 2036 0505</span></p>
</td>
<td>
<p><span style="font-weight: 400;">JCB</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
<td>
<p><span style="font-weight: 400;">APPROVED</span></p>
</td>
</tr>
</tbody>
</table>

**Card Verification Number (CVC)**: 
- Card Verification Number (CVC) = 123 for Card Types are MasterCard, Visa, Discover. Diners, JBC
- Card Verification Number (CVC) = 1234 for Card Type is American Express


## How to Configure

### 1. Configuration

Login to the Magento Admin, choose `Sales > Payment Settings > Payment Method > CommWeb Payment by Mageplaza > Configure`

![](https://i.imgur.com/sCkfQFs.png)

#### 1.1. Credentials

![](https://i.imgur.com/KrOFXfR.png)

- **Environment**:
  - Admin can choose **Sandbox environment** to check CommWeb functions.
  - When you want to apply for online payment, admin needs to change the environment to **Production**.
- **Public Key**:
  - Enter the **Public Key** get from the instructions [above](https://docs.google.com/document/d/1oWrPymSl7BNT5lhTbq89Ffkz7JpfewDEvUG61aSmEA8/edit#heading=h.j1oggb2ojlsa)
  - If left blank or incorrectly entered, the system will not connect to CommBank and display an error message
- **Private Key**:
  - Enter the **Private Key** get from the instructions [above](https://docs.google.com/document/d/1oWrPymSl7BNT5lhTbq89Ffkz7JpfewDEvUG61aSmEA8/edit#heading=h.j1oggb2ojlsa)
  - If left blank or incorrectly entered, the system will not connect to CommBank and display an error message
- **Test Credential** button: Admin can check the connection with CommBank by clicking the **Test Credential** button.


#### 1.2. Card

![](https://i.imgur.com/sCV2k5I.png)

- **Enable**: Select **Yes** to enable the use of payment features with CommWeb
- **Title**: Enter the title for the card, the name of the card will be displayed at the **Checkout page**, **Order Information** at the frontend and **Payment Information** in the backend.


- **Displayed at the checkout page**

![](https://i.imgur.com/dQ2ziHM.png)

- **Displayed in Order Information**

![](https://i.imgur.com/twogNYf.png)

- **Display at Payment Information in backend**

![](https://i.imgur.com/l2zzHyH.png)

- **Payment Action**:
![](https://i.imgur.com/K6Y77uX.png)
  - **Authorize**: Payment will only be captured when admin creates an invoice for customer's order. When the invoice is successfully created, admin can receive money from customer's card
  - **Authorize and Capture**: Payment will be captured immediately after the customer place order successfully. At that moment, the customer's card will pay for the order and the invoice will be created
- **New Order Status**: status of order when creating new payment with CommWeb.

![](https://i.imgur.com/DCdaIQW.png)

  - **Processing**: Status of order is **Processing** when order is completed. You can change the status in the backend with each order.
  - **Suspected Fraud**: The order's status is **Suspected Fraud** when the order is completed. You can change the status in the backend with each order. With this status admin can accept payment or reject payment and then transfer status to **Processing**.
  
  ![](https://i.imgur.com/qr6fiX8.png)

- **Show Logo**: Choose **Yes** to allow the CommWeb logo to be displayed at the frontend
- **Display Checkout**: Choose displaying style when checking out with CommWeb. There are several ways, as follows:

![](https://i.imgur.com/FdVO8T0.png)

  - **Magento Default**: Displays the payment method at Magento's default checkout page
  
  ![](https://i.imgur.com/GMZW5jp.png)

  - **Popup Checkout**: CommWeb payment method display when checkout as popup. When you click the **Place Order** button, the popup will appear. 
    - To use Popup Checkout, you must not use IP adress in the Magento domain. 
  
  ![](https://i.imgur.com/eo8AZUZ.png)
  
  - **Iframe Checkout**: CommWeb method payment display at the checkout page as CommWeb iframe insertion
  
  ![](https://i.imgur.com/qcFkZ9r.png)

- **Card Types**: Select the type of card that allows checkout, can select multiple types at once.

![](https://i.imgur.com/p1I0ugc.png)

- Cards will be authenticated when customer completes the card number when checking out. For cards not selected in this section, there will be an invalid message for the customer. With the card not selected, it will not be displayed on the Checkout page and Backend order.
- **Payment from Applicable Countries**: Select a country to apply the payment method
  - **All Countries**: Applies to all countries
  - **Specific Countries**: Only applicable for the countries selected in the **Payment from Specific Countries** field.
  - To restrict this payment with more conditions, see **Payment Restrictions** module.
    - **Payment from Specific Countries**: Select countries that are allowed to display and pay using CommWeb
- **Maximum Order Total**: Enter the maximum value of order to display and pay with CommWeb
  - If the value of the order is greater than the information of this school will not display CommWeb payment method when checkout
  - If left blank, there is no limit to the value of the order
- **Debug Mode**: If **Yes** is selected, diagnostic information is stored in log files on the Magento web server.
- **Sort Order**:
  - Specify the display position of payment method via CommWeb compared to other payment methods
  - 0 is the number with the highest display position. The smaller the number, the more priority will be displayed in the first position.

### 2. Admin Order

At Magento Admin, access `Sales> Orders > Action > View > Payment Information`, you can view payment information via CommWeb

![](https://i.imgur.com/ViCWSyU.png)

### 3. Order Frontend

Go to `My Account > My Orders > View Order`, you can view payment information with the CommWeb card saved at the **Payment Method section** of the order.

![](https://i.imgur.com/1pCJ95n.png)

**NOTE: Install the library for Mageplaza CommWeb extension**

When installing Mageplaza CommWeb extension you need to install its library: 

- Please visit [the link](https://commbank.simplify.com/commerce/docs/sdk/php#install) then click on the **Download link** 
- From the Magento site, go to the **/lib/internal** directory, then create a new folder called **Mageplaza**
- Unzip the downloaded file, add the **lib** folder in the downloaded file to the **Mageplaza** folder created above, change the lib name to **CommWeb**
- Add the php file called **registration.php** with the following command:

![](https://i.imgur.com/IGgpQep.png)
